function Loading(n=false,t="body"){$(t).loadingView({image:"/assets/libs/loading-indicator-view/loadingImage.gif",imageClassName:"loadingImage",state:n})}function debounce(n,t=500){let i;return(...r)=>{clearTimeout(i),i=setTimeout(()=>{n.apply(this,r)},t)}}function FixedHeader(){const n=$(".header_container"),t=n?.offset()?.top;$(window).on("scroll",()=>{let i=$(window).scrollTop();i>t?n.addClass("stuck"):n.removeClass("stuck")})}function Enter(n){return t=>{t.key==="Enter"&&(t.preventDefault(),n(t))}}function LazyLoadingImage(){function i(n){let t=n.classList.contains("loaded");if(!t){let t=n.getAttribute("data-src");n.classList.remove("isLoading");n.setAttribute("src",t);n.classList.remove("fadeOutImage");n.className=n.className+" fadeInImage loaded";n.removeAttribute("data-src")}}let n=document.querySelectorAll("img[loading]"),t=new IntersectionObserver(n=>{n.forEach(n=>{n.isIntersecting&&i(n.target)})});n.forEach(n=>{let i=n.classList.contains("loaded");i||n.classList.add("fadeOutImage");t.observe(n)})}function SelectLangChange(){$("#select_language, #select_language_mobile").change(n=>{let t=$(n.target),i=$(t).find("option:selected").attr("currenturl");window.location.href=i})}function SmartPhoto(){$(".js-img-viewer").SmartPhoto({arrows:!0,nav:!0,resizeStyle:"fit"})}function isMobileDevice(){return/Mobi|Android/i.test(navigator.userAgent)}function InitMobileMenu(){function t(){let n=$("#hc-nav-1 #searchInput").val();if(!(n.trim("").length<1)&&n){let t=`/search?key=${n}`;window.location.href=t}}let n=$(".header_mobile");$("#mobile_nav").hcOffcanvasNav({disableAt:1340,labelClose:"Close",labelBack:"Back",levelTitleAsBack:!0,pushContent:!1,levelOpen:"expand"});n.length&&n.show();$("#hc-nav-1 .btnSearchAction").click(()=>{t()});$("#hc-nav-1 #searchInput").keypress(Enter(()=>{t()}))}var WidgetGalleryImageHandler,HeaderHandler,SanPhamTheoDanhMucHandler,ChiTietSanPhamHandler,CartHandler,App;$(function(){FixedHeader();LazyLoadingImage();SelectLangChange();SmartPhoto();$("body").recentView();WidgetGalleryImageHandler.init()}),function(){var n=$({});$.each({trigger:"publish",on:"subscribe",off:"unsubscribe"},function(t,i){$[i]=function(){n[t].apply(n,arguments)}})}(),function(){$.fn.recentView=function(n){function r(n){t.$container=n;t.$recentview_productList=n.find(".recentview_productList")}function u(){function n(){let n=$(".product_detail_container")?.eq(0);if(t.$container.length>0&&i.getAll().length>0){let n=i.getAll();f(n).then(n=>{n&&(e(n),t.$recentview_productList.slick({cellAlign:"left",prevNextButtons:!0,freeScroll:!0,pageDots:!1,slidesToShow:4,slidesToScroll:1,responsive:[{breakpoint:900,settings:{rows:1,slidesToShow:3,slidesToScroll:1}},{breakpoint:600,settings:{rows:1,slidesToShow:1,slidesToScroll:1}}]}))})}if(n.length>0){let r=n.attr("productid"),t=i.getAll();i.exist(r)?(t.splice(t.indexOf(r),1),t.unshift(r)):t.unshift(r);t.length>10&&t.splice(10,t.length-1);i.save(t)}}t.$recentview_productList?.length>1&&n()}async function f(n){return new Promise(async(t,i)=>{try{let i=$.post("/home/products",{Ids:n});t(i)}catch(r){i(r)}})}function e(n){let i=n.map(n=>`
                        <div class="row productCard">
                            <a href="${n.url}" class="col-12 product_item_link">
                                <div class="row">
                                    <img class="product_item_img" loading="lazy" data-src="${n?.image?.url}">
                                </div>
                                <div class="row">
                                    <div class="py-3 productTitle font-weight-bold">${n.title}</div>
                                    <div class="">FROM $ ${n.price}</div>
                                </div>
                            </a>
                        </div>
                    `).join("");t.$recentview_productList.html(i);LazyLoadingImage()}let t=$.extend({},n),i={add:function(){},remove:function(){},getAll:function(){return JSON.parse(localStorage.getItem("viewedProducts"))||[]},exist:function(n){let t=this.getAll();return t.includes(n)},save:function(n){localStorage.setItem("viewedProducts",JSON.stringify(n))}};return this.each(function(){var n=$(this);r(n);u()})}}();WidgetGalleryImageHandler=function(){function t(){n.$btnLoadMore=n.el.find(".btnLoadGallery")}function i(){n.$btnLoadMore.click(n=>{let t=n.target,i=$(t).attr("widgetid"),r=$(t).attr("page"),u=$(t).attr("pagesize")})}function r(){n.el?.length>0&&(t(),i())}let n={el:$(".Widget_ImageGallery")};return{init:r}}();$(function(){HeaderHandler.init();isMobileDevice()&&InitMobileMenu()});HeaderHandler=function(){function t(){n.$btnSearch=n.parent.find("#btnSearch");n.$header_search_area=n.parent.find(".header_search_area");n.$btnCloseSearch=n.parent.find("#btnCloseSearch");n.$searchInput=n.parent.find("#searchInput");n.$btnSearchAction=n.parent.find(".btnSearchAction")}function i(){function t(){let t=n.$searchInput.val();if(!(t.trim("").length<1)&&t){let n=`/search?key=${t}`;window.location.href=n}}n.$btnSearch.click(()=>{n.$header_search_area.removeClass("active").addClass("active"),n.parent.removeClass("search").addClass("search"),n.$searchInput.focus()});n.$btnCloseSearch.click(()=>{n.$header_search_area.removeClass("active"),n.$searchInput.val(""),n.parent.removeClass("search")});n.$btnSearchAction.click(()=>{t()});n.$searchInput.keypress(Enter(()=>{t()}))}function r(){t();i()}let n={parent:$(".header_container")};return{init:r}}();$(function(){SanPhamTheoDanhMucHandler.init()});SanPhamTheoDanhMucHandler=function(){async function u(t){return Loading(!0),new Promise((i,r)=>{$.ajax({url:"/home/product_by_category",type:"GET",data:t,success:function(n){Loading(!1);i(n)},error:function(){Loading(!1);n.$productList.html("Không tìm thấy kết quả nào");n.$productList.data("totalRows",0);r(...arguments)}})})}async function f(){return new Promise(async(n,t)=>{try{let t=await $.get("/home/color_list");t&&n(t)}catch(i){t(i)}})}async function e(){return new Promise(async(n,t)=>{try{let t=await $.get("/home/size_list");t&&n(t)}catch(i){t(i)}})}async function o(){let o={CategoryId:n.$category_product_container.attr("categoryid")};t(o).then(()=>{let r=n.$productList.data("totalRows");console.log(r);let u=[];for(var t=1;t<=r;t++)u.push(t);n.$paginationModel=n.$category_product_pagination.pagination({dataSource:u,pageSize:n.$productList.data("pageSize"),autoHidePrevious:!0,autoHideNext:!0});n.$paginationModel.addHook("afterRender",i)});e().then(t=>{if(t){let i=t.map(n=>`<option value="${n.id}">${n.title}</option>`).join("");n.$sizeFilter.html(i)}}).then(()=>{n.$sizeFilter.fastselect({placeholder:"Chọn kích cỡ",searchPlaceholder:"Tìm kích cỡ",noResultsText:"Không tìm thấy kết quả"})});f().then(t=>{if(t){let i=t.map(n=>`<option value="${n.id}">${n.title}</option>`).join("");n.$colorFilter.html(i)}}).then(()=>{n.$colorFilter.fastselect({placeholder:"Chọn loại màu",searchPlaceholder:"Tìm màu",noResultsText:"Không tìm thấy kết quả"})});let r=[{name_asc:"Name ascending"},{name_desc:"Name descending"},{price_asc:"Price ascending"},{price_desc:"Price descending"},{date_asc:"Date ascending"},{date_desc:"Date descending"}],u="";for(let n=0;n<r.length;n++)if(n==0)u+=`<option value="" selected>Select order</option>`;else{let t=Object.keys(r[n])[0];u+=`<option value="${t}">${r[n][t]}</option>`}n.$select_order_product.html(u);setTimeout(()=>{$(".is-sticky").sticksy({listen:!1,topSpacing:100})},2500)}function s(t){let i=t?.items?.map(n=>`
                    <div class="row">
                        <a href="${n.url}" class="col-12 product_item_link">
                            <div class="row">
                                <img class="product_item_img isLoading" loading="lazy" data-src="${n.images.length>0&&n.images[0].src}"  />
                            </div>
                            <div class="row">
                                <div class="py-3 productTitle">${n.title}</div>
                                <div class="">FROM $ ${n.price}</div>
                            </div>
                        </a>
                    </div>
                    `);n.$productList.html(i);LazyLoadingImage();$("html, body").animate({scrollTop:n.$category_product_container.offset().top-100},100,"linear")}function i(){let u=n.$category_product_pagination.find(".paginationjs-page.active").attr("data-num"),i=r();i.CurrentPage=u;t(i)}async function t(t){return new Promise(async(i,r)=>{u(t).then(t=>{t.items&&(n.$productList.data("categoryid",n.$category_product_container.attr("categoryid")),n.$productList.data("currentPage",t.currentPage),n.$productList.data("pageSize",t.pageSize),n.$productList.data("totalPages",t.totalPages),n.$productList.data("totalRows",t.totalRows),s(t),i(t))}).catch(n=>{r(n)})})}function h(){n.$category_product_container=$(".category_product_container");n.$productList=$(".product_item_list");n.$category_product_pagination=$(".category_product_pagination");n.$sizeFilter=n.$category_product_container.find(".select_filter_size");n.$colorFilter=n.$category_product_container.find(".select_filter_color");n.$select_order_product=n.$category_product_container.find(".select_order_product");n.$filter_controls=n.$category_product_container.find(".filter_controls");n.$filterButton=n.$filter_controls.find(".btnFilter");n.originURL=window.location.origin+window.location.pathname}function c(){function u(){let u=r();t(u).finally(()=>{let u=n.$productList.data("totalRows"),r=[];for(var t=1;t<=u;t++)r.push(t);n.$paginationModel=n.$category_product_pagination.pagination({dataSource:r,pageSize:n.$productList.data("pageSize"),autoHidePrevious:!0,autoHideNext:!0});n.$paginationModel.addHook("afterRender",i)})}n.$filterButton.click(()=>{let t=n.originURL;productSizeValues&&(t=t+`?productSize=${productSizeValues}`);productColorValues&&(t=t+`&productColor=${productColorValues}`)});n.$sizeFilter.change(u);n.$colorFilter.change(u);n.$select_order_product.change(u)}function r(){let t=n.$category_product_container.find(".filter_size .fstChoiceItem"),i=n.$category_product_container.find(".filter_color .fstChoiceItem"),r=n.$select_order_product.val(),u=[...t]?.map(n=>$(n).attr("data-value")).join(",")||"",f=[...i]?.map(n=>$(n).attr("data-value")).join(",")||"";return{CategoryId:n.$productList.data("categoryid"),CurrentPage:n.$productList.data("currentPage"),PageSize:n.$productList.data("pageSize"),ProductSize:u,ProductColor:f,OrderBy:r}}function l(){n.container.length>0&&(h(),o(),c())}const n={currPage:1,pageSize:8,container:$(".Widget_HienThiSanPhamTheoDanhMuc")};return{init:l}}();$(function(){ChiTietSanPhamHandler.init()});ChiTietSanPhamHandler=function(){function t(){n.$product_images.slick({slidesToShow:1,slidesToScroll:1,centerMode:!1,accessibility:!0,arrows:!0,dots:!0,vertical:!1,verticalSwiping:!1,adaptiveHeight:!0});n.$product_detail_sidebar.sticksy({listen:!0,topSpacing:100});n.parentEl.find(".zoom").zoom({on:"mouseover",magnify:1.8});n.$color_items.eq(0).addClass("active");$.publish("OnColorActive",n.$color_items.filter(".active").attr("quantity"))}function i(){n.$product_detail_sidebar=n.parentEl.find(".product_detail_sidebar");n.$product_images=n.parentEl.find(".product_images");n.$select_size=n.parentEl.find(".select_size");n.$product_detail_quantity=n.parentEl.find(".product_detail_quantity");n.$sizes_container=n.parentEl.find(".sizes_container");n.$color_items=n.$sizes_container.find(".color_item");n.$btnAddToCart=n.parentEl.find("#btnAddToCart")}function r(){n.$color_items.not(".out").click(t=>{let i=t.target;n.$color_items.removeClass("active");$(i).addClass("active");let r=$(i).attr("quantity");$.publish("OnColorActive",r)});$.subscribe("OnColorActive",(t,i)=>{i&&(parseInt(i)==0?n.$product_detail_quantity.text("Out of order"):n.$product_detail_quantity.text(i))});n.$btnAddToCart.click(debounce(()=>{let t=n.$color_items.filter(".active"),i=t.attr("productid"),r=t.attr("sizeid"),f=t.attr("colorid"),e={ProductId:i,SizeId:r,ColorId:f,Quantity:1};u(e).then(()=>{$.publish("onCartChange")})},500))}function u(n){return Loading(!0),new Promise(async(t,i)=>{try{let i=await $.post("/addtocart",{data:n});Loading(!1);t(i)}catch(r){Loading(!1);i(r)}})}function f(){n.parentEl.length>0&&(i(),r(),t())}let n={parentEl:$(".product_detail_container")};return{init:f}}();$(function(){CartHandler.init()});CartHandler=function(){function r(){return new Promise(async(n,t)=>{try{let t=await $.get("/cartcount");n(t)}catch(i){t(i)}})}function u(n){return Loading(!0),new Promise(async(t,i)=>{try{let i=await $.post("/addtocart",{data:n});Loading(!1);t(i)}catch(r){Loading(!1);i(r)}})}function f(n){return new Promise(async(t,i)=>{try{let i=await $.post("/removeitem",{data:n});t(i)}catch(r){i(r)}})}function t(){return new Promise(async(n,t)=>{try{let t=await $.get("/carts");n(t)}catch(i){t(i)}})}function e(){n.$btnOpenCartHeader=$("#btnCart");n.$cartCount=$("#CartCount");n.$cartList=n.cart_panel.find(".cart_list");n.$input_item_quantity=n.cart_panel.find(".input_item_quantity");n.$btnCheckoutCart=n.cart_panel.find("#btnCheckoutCart")}function o(){n.$btnOpenCartHeader.click(r=>{r.preventDefault(),t().then(n=>{n&&i(n)}),n.cart_panel.open()});n.cart_panel.delegate(".input_item_quantity","change",debounce(n=>{let t=n.target;if($(t).val()){let n={ProductId:$(t).attr("productId"),SizeId:$(t).attr("sizeId"),ColorId:$(t).attr("colorId"),Quantity:$(t).val()-$(t).attr("oldQuantity")};u(n).then(()=>{$.publish("onCartChange")})}},500));n.cart_panel.delegate(".btnRemoveItem","click",n=>{n.preventDefault();let i=n.target,t=$(i).closest(".cart_item").find(".input_item_quantity"),r={ProductId:$(t).attr("productId"),SizeId:$(t).attr("sizeId"),ColorId:$(t).attr("colorId")};f(r).then(()=>{$.publish("onCartChange")})})}function i(t){let i=t.map(n=>`
                <div class="row cart_item mb-4">
                    <div class="col-5 cart_image_container">
                        <img class="cart_img" src="${n.imageSrc}" />
                    </div>
                    <div class="col-7">
                        <div class="row"><label>${n.productName}</label></div>
                        <div class="row"><label>${n.sizeValue} - ${n.colorValue}</label></div>
                        <div class="row"><label>$${n.price}</label></div>
                        <div class="row d-flex align-items-center mt-4">
                            <div class="col-sm-6">
                                <input class="input_item_quantity form-control"
                                        min="1" max="100"
                                        value="${n.quantity}" 
                                        type="number"
                                        productId=${n.productId}
                                        sizeId=${n.sizeId}
                                        colorId=${n.colorId}
                                        oldQuantity=${n.quantity}
                                            />
                            </div>
                            <div class="col-sm-6">
                                <a class="btnRemoveItem">Remove</a>
                            </div>
                        </div>
                    </div>
                </div>
            `);n.$cartList.html(i)}function s(){n.cart_panel.SlideOutPanel({slideFrom:"right",enableEscapeKey:!0,screenClose:!0,showScreen:!0});$.subscribe("onCartChange",()=>{t().then(n=>{n&&i(n)}).then(()=>{r().then(t=>{n.$cartCount.text(t)})})})}function h(){n.cart_panel.length>0&&(e(),s(),o())}let n={cart_panel:$("#cart_panel")};return{init:h}}();let existCheckoutForm=$(".checkout_container").length>0;$(function(){existCheckoutForm&&App.concern.initValidation()});App={};App.concern={initValidation:async function(){let t=$(".checkout_container"),n=$("#checkoutForm"),i=$("#btnCheckOut"),u=t.attr("lang"),r={ignore:"",rules:{fullname:{required:!0,maxlength:50},address:{required:!0,maxlength:100},mobilenumber:{required:!0,number:!0,minlength:10,maxlength:10}},messages:{},focusInvalid:!1,invalidHandler:function(){setTimeout(()=>{$(this).find(":input.error:first").focus()},10)}};n.validate(r);n.submit(n=>{n.preventDefault()});i.click(()=>{let t=n.valid();console.log(t)})}};